\chapter{Manejar las lenguas con \packagenoidx{Xunicode} y \packagenoidx{Polyglossia}}\index[pkg]{xunicode}\index[pkg]{polyglossia}\label{i18n}

\begin{intro}
    En este capítulo veremos la forma de indicarle a \LaTeX los cambios de lengua, así como los métodos para escribir en caracteres no latinos.
\end{intro}

\section{Indicar los cambios de lengua}

\subsection{¿Por qué indicar los cambios de lengua?}

Éstos son los principales motivos:
\begin{enumerate}
\item Cada lengua tiene sus propias reglas tipográficas (espaciado antes y/o después de los signos de puntuación, por ejemplo). De modo que indicar la lengua que usamos permite a \LaTeX adaptarse a su tipografía.
\item Cada lengua tiene sus propias reglas para dividir las palabras: indicar la lengua permite tener una división correcta.
\end{enumerate}


\subsection{Comandos y entornos para cambiar de lengua}

\subsubsection{Lengua principal y lenguas secundarias}

Hemos visto que se indicaba en el preámbulo el español como lengua principal por medio del comando:\cs{setmainlanguage}\verb|{spanish}|\renvoi{spanish}.



Evidentemente, podríamos indicar otra lengua: por ejemplo, si escribes tu trabajo en griego:
\cs{setmainlanguage}\verb|{greek}|.

Incluso podríamos precisar que se trata de griego antiguo\footnote{Al autor de estas líneas le gusta demorar ciertas globalizaciones, por lo que prefiere el griego antiguo al inglés.}: 

\begin{latexcode}
\setmainlanguage[variant=ancient]{greek}
\end{latexcode}

Hay una lista de las lenguas disponibles y de sus variantes en la documentación de \package{polyglossia}\footcite{polyglossia}. En caso de que tu lengua no esté disponible, tienes tres alternativas:
\begin{itemize}
\item mira si el package \package{babel} no puede hacer nada por ti;
\item escribe al autor\footnote{Del package, no de estas líneas.} dándole el nombre de la lengua y sus reglas tipográficas y de división de palabras y pídele amablemente que añada una lengua a \package{polyglossia};
\item no respetes los buenos motivos que hay para indicar los cambios de lengua.
\end{itemize}

Para poder indicar cambios de lengua, hay que declarar en el preámbulo las lenguas secundarias: 
\csp{setotherlanguage}\oarg{opciones}\marg{codigoleng}, donde \arg{codigoleng} se sustituye por el código de la lengua, por ejemplo,  \contenuarg{greek}.

Las opciones son sustancialmente las variantes, pero también puede tratarse de opciones de presentación de números o de fechas: véase el manual de \package{polyglossia}\footcite{polyglossia_options}.

\subsection{Indicar un cambio de lengua}\label{changerlang}

Hay dos formas de indicar un cambio de lengua.

\subsubsection{Mediante un comando}

Se puede hacer por medio de un comando 
\csp{texto\meta{codigoleng}}\oarg{opciones}\marg{texto en otra lengua}, por ejemplo\footnote{\bibleverse{Eu.Io.}(1:1).}: 

\begin{latexcode}
\textgreek[variant=ancient]{Ἐν ἀρχῇ ἦν ὁ λόγος}
\end{latexcode}

\subsubsection{Mediante un entorno}

Para textos más largos, quizá resulte más interesante utilizar un entorno \enviro{\meta{codigoleng}}:

\begin{latexcode}
\begin[variant=ancient]{greek}
Ἐν ἀρχῇ ἦν ὁ λόγος, 
καὶ ὁ λόγος ἦν πρὸς τὸν θεόν,
καὶ θεὸς ἦν ὁ λόγος.
\end{greek}
\end{latexcode}

\subsection{El problema del latín}\label{redefinirlatin}

En el package \package{polyglossia} el latín sigue la tipografía inglesa. Así, un francófono tendrá algunos problemas si desea espacios ante los signos tipográficos dobles en un entorno \enviro{latin} o en un comando \csp{textlatin}.
Sin embargo, podría querer emplear este entorno o este comando para respetar la división de palabras del latín.

Para hacerlo, tendrá que redefinir en el preámbulo el entorno \enviro{latin} con el código siguiente:

\begin{latexcode}
\renewenvironment{latin}{\begin{hyphenrules}{latin}}%
{\end{hyphenrules}}
\end{latexcode}

\begin{plusloins}
El comando \csp{renewenvironment} redefine un entorno, en nuestro caso \enviro{latin}. El segundo argumento del comando indica lo que ocurre cuando se abre el entorno y el tercer argumento, lo que se produce cuando se cierra el entorno. El entorno \enviro{hyphenrules} indica un cambio en las normas de división de palabras.
\end{plusloins}


\section{Escribir textos con caracteres no latinos}\label{utf8}

Lo que vamos a explicar ahora no tiene realmente mucho que ver con \LaTeX. Se trata, de hecho, de un problema más general de la informática: ¿cómo escribir con caracteres no latinos? Explicaremos aquí el método malo y, a continuación, el método bueno.

Empezaremos con algunas explicaciones técnicas muy simplificadas: que los puristas nos perdonen.

\subsection{Los juegos de caracteres: o cómo usar los números para cosas distintas a las matemáticas}

En principio, un ordenador no manipula más que números. Pero los ordenadores están al servicio de los humanos, los que les han enseñado a \enquote{almacenar} caracteres, asociando letras a números.

Sin embargo, como los primeros ordenadores fueron desarrollados por anglosajones, sólo se asociaron números a 127~caracteres, lo que bastaba de sobra para escribir en inglés y añadir caracteres específicos, como las llaves informáticas\footnote{Las que tú utilizas para los comandos \LaTeX.}.  Así fue como vio la luz el juego de caracteres conocido con el delicado nombre de ASCII\footnote{\emph{\textenglish{American Standard Code for Information Interchange.}}}.

Un día, pueblos distintos a los anglosajones quisieron escribir con un ordenador y desearon introducir sus propios caracteres. Por ejemplo, los europeos occidentales quisieron introducir acentos, cedillas, diéresis y otras preciosidades. Así que se creó un nuevo sistema de codificación para representar los caracteres latinos occidentales, asociando números a otros caracteres. Así se originó el juego de caracteres  ISO-8859-1. 

Otros quisieron escribir en su propio alfabeto y así fue como se inventaron juegos de caracteres como ISO-8859-5 para el cirílico. Además, algunas empresas inventaron sus propias formas de almacenar caracteres:  así Apple inventó MacRoman y Microsoft Windows-1252\footnote{De ahí que, durante mucho tiempo, los acentos \enquote{brincaran} constantemente cuando se enviaba un correo electrónico de un ordenador Apple a un PC con Windows o viceversa.}. 

Pero algunas personas querían mezclar caracteres de alfabetos distintos: por ejemplo, escribir a veces en griego, otras, en cirílico, otras en caracteres latinos. ¿Cómo hacerlo? Durante mucho tiempo, la técnica empleada\footnote{Que, por desgracia, todavía la practican personas que no están muy al tanto de las evoluciones en informática.} consistía en escribir en un juego de caracteres determinado, por lo general ISO-8859-1, pero utilizando una fuente que presentaba el texto en un alfabeto distinto. 

Por ejemplo, para escribir la letra griega \enquote{α} se escribía la letra latina \enquote{a} y se la hacía aparecer con la fuente SPIonic. Este método planteaba ---y todavía plantea--- muchos problemas:
\begin{itemize}
\item requería que la fuente estuviese instalada en todos los ordenadores en los que se trabajaba;
\item al no almacenar la información exacta sobre el carácter, ya que emplea un código para designar algo distinto de lo que tenía que designar, no permitía realizar búsquedas con facilidad;
\item con \LaTeX, dado que no estamos en un sistema WYSIWIG, convertía la redacción y la revisión en una labor extremadamente complicada;
\item era un sinsentido informático y lógico. 
\end{itemize}

Una sencilla metáfora explica el problema: supongamos que quisieras una casa de ladrillo rojo. ¿Qué dirías si tu empresa de albañilería te pusiera piedra y después la pintara de rojo para hacer creer que se trataba de ladrillo? Éste es el problema fundamental de este método: coge piedra (la letra \enquote{a}) en vez de ladrillo (la letra \enquote{α}) utilizando una pintura (la fuente).

Por fortuna, poco a poco se encontró una solución: consistió en inventar un juego de caracteres que pudiera almacenar todos los caracteres que hay en la tierra, incluidos los del pasado, dejando sitio para los caracteres de civilizaciones extraterrestres con las que quizá nos encontremos algún día. Ese juego de caracteres se llama \emph{Unicode}.

Con este juego de caracteres se puede, por tanto, mezclar alegremente árabe, vietnamita, hebreo y cirílico en un mismo fichero. Sin embargo, para complicar las cosas, se inventaron varias implementaciones para este juego de caracteres, cada una de las cuales presenta ventajas e inconvenientes diversos\footnote{Por ejemplo, en lo que afecta al volumen de los ficheros y a los tiempos de búsqueda.}. La más habitual de estas implementaciones es UTF-8.

Es la que utilizas desde que estás leyendo este libro, por lo menos si has leído el capítulo~\ref{commencer}.

En una palabra: Unicode con su variante UTF-8 es actualmente el mejor método para escribir ficheros mezclando varias familias de caracteres\footnote{El autor incluso cree que, dados los bajos costes de almacenamiento y transferencia, no se debería usar más que este juego de caracteresL'auteur pense même que, étant donné la baisse des coûts de stockages et de transferts, on ne devrait plus utiliser que ce jeu de caractères, lo que permitiría a todos los pueblos expresarse con más facilidad en su lengua. Por desgracia, su experiencia personal le demuestra que éste no siempre es el caso todavía.}.

\begin{attention}
El sistema Unicode es más complejo de lo que hemos explicado. Así, algunos caracteres compuestos se pueden codificar de varias maneras. Tomemos, por ejemplo, la letra griega \enquote{alfa con iota suscrita} (ᾳ). Se puede codificar:
\begin{itemize}
	\item Con el carácter \enquote{\textenglish{greek small letter alpha with ypogegrammeni}} (\verb|U+1FB3|).
	\item Con el carácter \enquote{\textenglish{greek small letter alpha}} (\verb|U+03B1|) seguido del carácter \enquote{\textenglish{combining greek ypogegrammeni}} (\verb|U+0345|)\footnote{Los números de los caracteres unicode se notan con la forma U+número hexadecimal.}. 
\end{itemize}

En teoría, ambas fuentes tienen que producir el mismo resultado con estas dos codificaciones. En la práctica, no siempre es así\footcite[Para los ejemplos y más explicaciónes, véase:][]{normalisation_unicode}. Por eso se recomienda escribir el siguiente código en el preámbulo:
\begin{latexcode}
\XeTeXinputnormalization 1
\end{latexcode}

Esto tiene como consecuencia actuar como si los caracteres estuvieran codificados según el primer método de manera unitaria.
\end{attention}

\begin{plusloins}
El lector socarrón constatará que se plantea el mismo problema que con el método de la fuente: es decir, que cada ordenador de trabajo tendría que tener instalado Unicode y UTF-8. 

El autor responde que hoy en día todos los ordenadores ofrecen estas posibilidades de serie, y que se pueden instalar con gran facilidad en ordenadores algo viejos. Además, con Unicode se almacena sentido, y no forma, lo que permite mayor flexibilidad. 
\end{plusloins}


\subsection{En concreto}

Muy bien, muy bien, almacenemos en UTF-8. Pero, ¿cómo se escribe en UTF-8? Con los teclados que se venden en la Europa occidental\footnote{El lector activista sabrá perdonar este toque de etnocentrismo.}, no tenemos a mano los caracteres griegos.

Hay que diferenciar aquí el soporte físico: el teclado con sus teclas muy concretas, y el soporte lógico: el hecho de que pulsar tal tecla da tal o cual carácter. 

Para retomar nuestro caso, basta con decirle a nuestro ordenador que la tecla A se corresponde a la letra α. Los ordenadores recientes ofrecen varios controladores de teclado de serie\footnote{En Macintosh, esto se ajusta en las Preferencias del Sistema, carpeta \enquote{International}, en Windows se ajusta en las carpetas de configuración, carpeta \enquote{opciones regionales y de lengua}; en Linux, se encuentra el ajuste en los Parámetros del Sistema, carpeta \enquote{País y lengua}, pestaña \enquote{Accesorios}.}. Sin embargo, estos controladores de teclado están pensados por lo general para lenguas actuales y rara vez se adaptan a las lenguas antiguas ---por ejemplo, para los acentos del griego. Afortunadamente, se encuentran con facilidad en Internet controladores de teclado para otras lenguas\footcites[Por lo que respecta al griego antiguo, el siríaco, el hebreo antiguo, se pueden emplear los teclados propuestos por Michael Langlois:][]{clavierLanglois}[o también, para el griego, los teclados de la École Normale Supérieure][]{clavierENS}.

\begin{plusloins}
Unicode  permite almacenar todos los caracteres existentes en la tierra, pero de su presentación se encarga una fuente. No hay ninguna fuente que gestione todos los caracteres unicode. Por eso puede resultar útil indicar una fuente específica para algunas lenguas. Hablamos de esto en un capítulo dedicado a la gestion de las fuentes\renvoi{policenonlatine}.
\end{plusloins}

\subsection{¿Y los cambios de sentido de la escritura?}

Algunas lenguas se escriben de derecha a izquierda, otras de izquierda a derecha. Sería deseable que la alineación de los párrafos, las posiciones de los títulos y otros elementos se ajustaran al sentido de escritura de la lengua. ¿Cómo señalárselo a \LaTeX{}? Basta la indicación de cambios de lengua\renvoi{changerlang}. 

\begin{plusloins}
En lo que respecta a la escritura en bustrofedón, se puede usar el package \package{bidi}. Tiene comandos que permiten indicar cambios en el sentido de la escritura. 
\end{plusloins}
